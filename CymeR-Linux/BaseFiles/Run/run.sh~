#!/bin/bash
DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
parentDIR="$(dirname "$DIR")"
grandparentDIR="$(dirname "$parentDIR")"
greatgrandparentDIR="$(dirname "$grandparentDIR")"
xhost + && \
xterm -e docker rm `docker ps --no-trunc -aq` && \
xterm -e docker run -ti --rm -e DISPLAY=$DISPLAY -v $greatgrandparentDIR/CymeR-Workspace:/home/developer/knime-workspace -v $greatgrandparentDIR/Scripts:/home/developer/Scripts -v $greatgrandparentDIR/CymeR-Data:/home/developer/Data:rw -v $greatgrandparentDIR/Templates:/home/developer/Templates:rw -v /tmp/.X11-unix:/tmp/.X11-unix:rw bmuchmore/cymer
xterm -e docker rm `docker ps --no-trunc -aq`



cd Desktop
cd CymeR
cd CymeR-Linux
cd BaseFiles
cd Run
DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
parentDIR="$(dirname "$DIR")"
grandparentDIR="$(dirname "$parentDIR")"
greatgrandparentDIR="$(dirname "$grandparentDIR")"
docker run -ti --rm -v $greatgrandparentDIR/CymeR-Workspace:/home/developer/knime-workspace -v $greatgrandparentDIR/Scripts:/home/developer/Scripts -v $greatgrandparentDIR/CymeR-Data:/home/developer/Data:rw -v $greatgrandparentDIR/Templates:/home/developer/Templates:rw bmuchmore/cymer /bin/bash





sudo sed -i "16 a \ \ \ \ \ \ packages=['wishbone']," /opt/python3.5/lib/python3.5/site-packages/wishbone/setup.py 
sudo sed -i -e "s@os.makedirs( os.path.expanduser('~/.wishbone/gsea/'), exist_ok=True )\n@os.makedirs( os.path.expanduser('~/.wishbone/gsea/'), exist_ok=True )@g" /opt/python3.5/lib/python3.5/site-packages/wishbone/setup.py
sudo sed -i "/'tsne',/d" /opt/python3.5/lib/python3.5/site-packages/wishbone/setup.py


sudo sed -i "/from tsne import bh_sne/d" /opt/python3.5/lib/python3.5/site-packages/wishbone/src/wishbone/wb.py
sudo sed -i "25 a from sklearn.manifold import TSNE" /opt/python3.5/lib/python3.5/site-packages/wishbone/src/wishbone/wb.py

sudo sed -i "/self.tsne = pd.DataFrame(bh_sne(data),/d" /opt/python3.5/lib/python3.5/site-packages/wishbone/src/wishbone/wb.py
sudo sed -i "401 a \ \ \ \ \ \ tsne = TSNE(n_components=2, init='random', random_state=sum(data.shape))" /opt/python3.5/lib/python3.5/site-packages/wishbone/src/wishbone/wb.py
sudo sed -i "402 a \ \ \ \ \ \ self.tsne = pd.DataFrame(tsne.fit_transform(data)," /opt/python3.5/lib/python3.5/site-packages/wishbone/src/wishbone/wb.py




